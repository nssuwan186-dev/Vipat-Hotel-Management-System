# Google Workspace Integration Enhancements

This document outlines the conceptual implementation for enhancing the integration of the Hotel Management System with Google Workspace.

## 1. Google Drive Integration

**Objective:** Store generated documents, such as invoices and receipts, directly in a user-specified Google Drive folder.

### Backend (Google Apps Script)
- A new function `createFileInDrive(file)` will be added.
- This function will take a file object (containing name, mimeType, and content) as input.
- It will use the `DriveApp` service to create the file in a designated folder.
- It will return the URL of the created file.
- Folder ID will be stored as a script property for easy configuration.

### Frontend
- The `googleApiService.ts` will have a new `saveToDrive(file)` function.
- In the `Reports` component, a "Save to Drive" button will be added next to each generated document.
- Clicking this button will trigger the `saveToDrive` function, and the UI will be updated with the file URL upon success.

## 2. Google Calendar Integration

**Objective:** Automatically create and update Google Calendar events for bookings.

### Backend (Google Apps Script)
- New functions `createCalendarEvent(booking)` and `updateCalendarEvent(booking)` will be created.
- These functions will use the `CalendarApp` service to interact with a specific calendar (configurable via script property).
- The event title will include the guest's name and room number.
- The event description will contain booking details.
- The booking ID will be stored in the event's extended properties to link the calendar event to the booking.

### Frontend
- The `addBooking` and `updateBooking` functions in `googleApiService.ts` will be updated to call the corresponding calendar functions in the backend.
- In the `Bookings` component, a "View on Calendar" link could be added for each booking, which would link to the Google Calendar event.

## 3. Gmail Integration

**Objective:** Send email notifications for events like booking confirmations or invoice reminders.

### Backend (Google Apps Script)
- A new function `sendEmail(recipient, subject, body)` will be added.
- It will use the `GmailApp` service to send emails.
- Email templates will be created in Google Docs for easy editing and personalization.

### Frontend
- The `googleApiService.ts` will have a `sendNotification(emailDetails)` function.
- After a new booking is created, the frontend will call this function to send a confirmation email.
- A feature could be added in the `Finance` component to send reminder emails for unpaid invoices.

## 4. AI Assistant Enhancement (Gemini API)

**Objective:** Provide deeper data analysis, automate tasks, and offer a more conversational experience.

### Backend (Google Apps Script)
- A new function `getAiInsights(prompt, context)` will be created.
- This function will make a direct call to the Gemini API using `UrlFetchApp`.
- It will pass a carefully constructed prompt along with relevant data (e.g., a summary of recent bookings or expenses) as context.

### Frontend
- The `AiAssistant.tsx` component will be updated to send more complex queries to the backend.
- The UI will be enhanced to display not just text but also charts or summaries generated by the AI.
- The AI will be able to trigger actions, such as creating a new task or generating a report, by calling the relevant API functions.
